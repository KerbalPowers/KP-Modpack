// BDA rebalancing configs for use with KP3:

// General approach:

// Tweaked the costs of things based on their relative usefullness on the battlefied.  Rough template i used is ~500 for MGs, ~1000-1500 for exposed autocannons, ~3500 for most tank and high end AA turrets, and ~7000 for artillery turrets.

// HP of parts somewhat standardized to ~500 for smaller exposed MG/autocannons, ~5000 for AA turrets, ~10000 for BMP or smaller tank turrets, and ~18000 for full sized MBT turrets.

// Accuracy was buffed in general with the main change being MBT turrets going from a spread of 0.1 to ~0.05 which allows them to be effective at ~2km against a MBT sized target.  Some guns which would have never been picked before due to pathetic base stats (majority of the BDAExpanded turrets for example) were brought up to a state where they are closer to the MBT turrets to act as a sidegrade rather then a leave it at home and never look back.  There is ofc some variation between even near identical turrets with very slight tradeoffs for rate of fire or accuracy but these variations are very slight and nomatter what MBT turret you pick it will still feel like a MBT turret.

// Added some better sounds to the guns which should hopefully be a bit less bland.

// Added integrated ammunition to most turrets which lacked it before and appear to be able to physically fit actual ammo inside them.  The amount will need to be tweaked in the future per turret but the idea is to cut down on how many ammo bins people need to bring while still making it a need that people have to balance and design the tanks around.

//fixed the broken TOW hitting the ground (set the height manually using the BDA setting to something very low like 50 or 100m AGL)

//added HEAT ammo as an alternative choice for anti-tank duty, it is balanced to be far more destructive to armor itself (HP damage) while having less penetration, low velocity and being interceptable by the APS system.  Its strong at point blank ranges and will evicerate anything with sub 100mm plating but takes alot of hits to take down a heavy tank's armor panels.






////////////////////////////////////////////////////////
// missile HP patch
////////////////////////////////////////////////////////
@PART[*]:HAS[@MODULE[MissileLauncher]]:FINAL
{

	%MODULE[HitpointTracker]
	{
		ArmorThickness = 10
		maxHitPoints = 500 //Buff, original was 5
	}
}

////////////////////////////////////////////////////////
// missile dumb terminal patch
////////////////////////////////////////////////////////
@PART[*]:HAS[@MODULE[MissileLauncher]]:FINAL
{
  %MODULE[MissileLauncher]
  {
    %dumbTerminalGuidance = false
  }
}

////////////////////////////////////////////////////////
// .50cal machine guns
////////////////////////////////////////////////////////
@PART[bahaBrowningAnm2]:FINAL //single 50cal turret
{

  %MODULE[ModuleWeapon]
  {
	%tracerInterval = 2
	%explModelPath = BDArmory/Models/explosion/30mmExplosion
	%explSoundPath = BDArmory/Sounds/subExplode
	
	%maxHeat = 3600
	%heatPerShot = 85 //was 115, slight buff as it just overheats insanely fast for its low damage output
	%heatLoss = 825
  }
  %MODULE[HitpointTracker]
  {
	%maxHitPoints = 500 //enough HP to not be instantly shot off but low enough that a direct hit from anything serious will annihilate it.
  }
}

@PART[bahaTurret]:FINAL //base dual 50cal turret
{

  %MODULE[ModuleWeapon]
  {
	%tracerInterval = 2
    %fireSoundPath = BDArmory/Parts/browninganm2/sounds/fire
	%explModelPath = BDArmory/Models/explosion/30mmExplosion
	%explSoundPath = BDArmory/Sounds/subExplode
	
	%maxHeat = 3600 //no overheating as the weapon is terribad enough as it is
	%heatPerShot = 0
	%heatLoss = 820
  }
  %MODULE[HitpointTracker]
  {
	%maxHitPoints = 10000 //unique way to make it actually worth considering over other MGs.  Shit stats but it can take a beating even placed on the front glasis due to the armored shell design (looks much sturdier then any other small turret actually).
  }
}
////////////////////////////////////////////////////////
// 20mm exposed autocannons
////////////////////////////////////////////////////////
@PART[bahaGatlingGun]:FINAL
{

  %MODULE[ModuleWeapon]
  {
	%bulletType = 20x102mmHEBullet; 20x102mmBullet //; 20x102mmHEATBullet2
    %maxDeviation = 0.2 //was 1.02, made this very accurate to at least somewhat compete with the M230 at longer ranges plus the weapon overheats incredibly fast making it unsuited for point defense
	%tracerInterval = 4 //was 3
	
	%maxHeat = 3600
	%heatPerShot = 30
	%heatLoss = 820
  }
  %MODULE[ModuleTurret]
  {
    %yawRange = 360 //was 90
  }
  %MODULE[HitpointTracker]
  {
	%maxHitPoints = 1500 //standard for exposed mgs/autocannons
  }
}

////////////////////////////////////////////////////////
// SIDAM 25mm AA
////////////////////////////////////////////////////////
@PART[bahaSidamTurret]:FINAL
{
  
  %MODULE[ModuleWeapon]
  {
	%bulletType = 25x137mmAPBullet2; 25x137mmBullet   
	%maxDeviation = 0.16 //was 0.01, increased to make it a tradeoff between this and the jap triple 25mm which is much slower firing but more accurate.
	%tracerInterval = 1
	
	%maxHeat = 3600
	%heatPerShot = 0 //was 65
	%heatLoss = 750
  }
  %MODULE[HitpointTracker]
  {
	%maxHitPoints = 10000 //making this turret the strongest dedicated AA turret armor wise for some variety and besides the turret its in looks fairly beefy compared to the other more exposed AA weapons
  }
  %RESOURCE[25x137Ammo] //adding integrated 2x ammo box
  {
    %amount = 1300
    %maxAmount = 1300
  }
}
////////////////////////////////////////////////////////
// 30mm M230
////////////////////////////////////////////////////////
@PART[bahaM230ChainGun]:FINAL
{
  
  %MODULE[ModuleWeapon]
  {
	%bulletType = M230Bullet2
    %maxDeviation = 0.16 //was 0.45
	%tracerInterval = 1 //was 3
	
	%maxHeat = 3600
	%heatPerShot = 166 //was 210
	%heatLoss = 820
  }
  %MODULE[ModuleTurret]
  {
    %yawRange = 360 //was 170
  }
  %MODULE[HitpointTracker]
  {
	%maxHitPoints = 1500 //standard for exposed autocannons
  }
}

////////////////////////////////////////////////////////
// 30mm goalkeeper
////////////////////////////////////////////////////////
@PART[bahaGoalKeeper]:FINAL //high end goalkeeper (mostly meant for ship useage)
{
  
  %MODULE[ModuleWeapon]
  {
	%bulletType = 30x173Bullet3
  	%maxDeviation = 0.12 //was 0.64, ship version buffed accuracy
	%tracerInterval = 1
	%minSafeDistance = 0
	%bulletDmgMult = 0.8
	
	%maxHeat = 3600
	%heatPerShot = 0 //was 36, will still overheat if firing non-stop but it will take a while
	%heatLoss = 900
	
	%isAPS = true //temporary fix as dual mode APS is broken
	%dualModeAPS = true
  }
  %MODULE[ModuleTurret]
  {
	%pitchSpeedDPS = 100 //buff as this gun is CIWS and needs to be able to swap between missiles rapidly
	%yawSpeedDPS = 100
  }
  %MODULE[HitpointTracker]
  {
	%maxHitPoints = 8000
  }
  %RESOURCE[30x173Ammo] //adding ammo as the goalkeeper is massive and eats absurd amount of ammo
  {
    %amount = 2000
    %maxAmount = 2000
  }
}

////////////////////////////////////////////////////////
// 35mm OERLINKOLN, ~75mm pen, AA
////////////////////////////////////////////////////////
@PART[bahaOMillennium]:FINAL
{
  
  %MODULE[ModuleWeapon]
  {
	%bulletType = MILAP; MILHE; MILHEAD
  %maxDeviation = 0.036
	%tracerInterval = 12
	%maxTargetingRange = 8000
	%maxEffectiveDistance = 5000
	%minSafeDistance = 0
	
	%maxHeat = 3600
	%heatPerShot = 0 //was 65
	%heatLoss = 750
	
	%isAPS = true //temporary fix as dual mode APS is broken
	%dualModeAPS = true
	}
  %MODULE[HitpointTracker]
  {
	%maxHitPoints = 4000
  }
  %RESOURCE[30x173Ammo] //adding integrated ammo box, not quite accurate but we do not have any 35mm rounds in base BDA and 37mm ammo is way too heavy for such a fast firing gun
  {
    %amount = 600
    %maxAmount = 600
  }
}

////////////////////////////////////////////////////////
// 37mm BDAE double barrel and CIWS
////////////////////////////////////////////////////////
@PART[baha37mmTurret]:FINAL
{

  %MODULE[ModuleWeapon]
  {
	%bulletType = 37x155HEShell2; 37x155APShell2
    %maxDeviation = 0.1 //was 0.7, buffed as 0.7 accuracy for such a slow firing weapon is abyssmally bad
    %fireSoundPath = BDArmoryAdditions/AKSTechnologies/37mm61k
	%tracerInterval = 3

	%isAPS = true //temporary fix as dual mode APS is broken
	%dualModeAPS = true
  }
  %MODULE[HitpointTracker]
  {
	%maxHitPoints = 8000 //standard for exposed mgs/autocannons
  }
  %RESOURCE[baha37mmAmmo] //adding integrated ammo
  {
    %amount = 200
    %maxAmount = 200
  }
}
@PART[baha37mmCIWS]:FINAL
{

  %MODULE[ModuleWeapon]
  {
	%bulletType = 37x155HEShell2; 37x155APShell2; 37x155FLAKShell2
  %maxDeviation = 0.20
  %tracerInterval = 1
  %minSafeDistance = 0
	
	%heatPerShot = 0 //was 55
	
  }
  %MODULE[HitpointTracker]
  {
	%maxHitPoints = 8000 //standard for exposed mgs/autocannons
  }
  %RESOURCE[baha37mmAmmo] //adding integrated ammo
  {
    %amount = 360
    %maxAmount = 360
  }
}

////////////////////////////////////////////////////////
// USAF AIRBORNE LASER
////////////////////////////////////////////////////////
@PART[bahaABL]:FINAL
{
  
  %MODULE[ModuleWeapon]
  {
	%laserDamage = 800
	%tanAngle = 0.00001
	%pulseLaser = true
	%roundsPerMinute = 250
	%maxDeviation = 0.001 
	
	%RoundsPerMag = 10
    %ReloadTime = 10
	%BurstFire = true

	%ammoName = ElectricCharge
	%requestResourceAmount = 100

	%tracerStartWidth = 0.6
	%tracerMaxStartWidth = 0.6 //post-beamGrow tracer widths
	%tracerEndWidth = 0.6
	%tracerMaxEndWidth = 0.6
  }
  
}

////////////////////////////////////////////////////////
// 105mm howie
////////////////////////////////////////////////////////
@PART[bahaM102Howitzer]:FINAL
{
  
  %MODULE[ModuleWeapon]
  {
	%bulletType = KP105mmBullet; KP105mmHEATBullet2; KP105mmHESHBullet; KP105mmHETFBullet;
    %maxDeviation = 0.05 //was 0.2
	%roundsPerMinute =  10 // 6s
    %fireSoundPath = BDArmoryAdditions/AKSTechnologies/100mmd10c
	%reloadAudioPath = BDArmoryAdditions/AKSTechnologies/shellload

	%bulletDmgMult = 3
  }
  %MODULE[HitpointTracker]
  {
	%maxHitPoints = 750
  }
  %RESOURCE[CannonShells] 
  {
    %amount = 20
    %maxAmount = 20
  }
}

////////////////////////////////////////////////////////
// 120mm MBT TURRETS, ~1500mm pen, optimal for brawling
////////////////////////////////////////////////////////
@PART[bahaM1Abrams]:FINAL
{
  
  %MODULE[ModuleWeapon]
  {
	%bulletType = 120mmBullet2; 120mmBulletHEAT2; 120mmBulletHEAT3; 120mmBulletHE2; 120mmBulletHIVE2
    %maxDeviation = 0.05 //was 0.2
	%roundsPerMinute =  13.33 // 4.5s
    %fireSoundPath = BDArmoryAdditions/AKSTechnologies/100mmd10c
	%reloadAudioPath = BDArmoryAdditions/AKSTechnologies/shellload

	%bulletDmgMult = 3
  }
  %MODULE[HitpointTracker]
  {
	%maxHitPoints = 10000
  }
  %RESOURCE[CannonShells] //adding integrated 1x ammo drum (2x capacity) as it burns thru ammo faster then other guns
  {
    %amount = 40
    %maxAmount = 40
  }
}


////////////////////////////////////////////////////////
// MISSILES
////////////////////////////////////////////////////////
@PART[bahaTowMissile]:FINAL
{
  
  %MODULE[MissileLauncher]
  {
    %missileType = missile
	%homingType = AGM //was BeamRiding, for whatever dumb reason beamriding seems to hit the ground 90% of the time when ground is flat
	%targetingType = laser
	%maxOffBoresight = 200 //was 65, increased to permit VLS firing
  }
  %MODULE[BDExplosivePart]
  {
	//%tntMass = 6.14 // TOW-2B Warhead
	//%tntMass = 3.9 // TOW Warhead
	%tntMass = 5.9 // TOW2A Warhead
	%caliber = 152
	%warheadType = ShapedCharge
  }
}

@PART[bahaAGM-114]:FINAL //hellfire
{
  
  %MODULE[MissileLauncher]
  {
    %missileType = missile
	%targetingType = laser
	%maxOffBoresight = 200 //was 65, increased to permit VLS firing
  }
  %MODULE[BDExplosivePart]
  {
	%tntMass = 32 //was 8, increased to give it superior HP damage to armor over cannon shell HEAT.
	%warheadType = ShapedCharge
	%caliber = 172
	%apMod = 0.5 // 800mm of penetration
  }
}

@PART[bahaAGM-65]:FINAL //maverik
{
  
  %MODULE[MissileLauncher]
  {
    %missileType = missile
	%homingType = AGM
	
	%targetingType = heat
	%heatThreshold = 0.5
	%radarLOAL = true
	%uncagedLock = true
	%lockedSensorFOV = 0.1
	%flareEffectivity = 0.1
	%maxOffBoresight = 65 //was 65, increased to permit VLS firing
	
  }
  %MODULE[BDExplosivePart]
  {
  	%tntMass = 191 //was 85.5, high enough to basically 1 shot a turret reliably if it hits
	%caliber = 305
	%apMod = 0.3351975632 // 950 mm of penetration, given that missiles hit top-down, this is more then enough to go clean through any tank
	%warheadType = ShapedCharge
  }
}

@PART[bahaHATG]:FINAL //Mattock
{
  %MODULE[MissileLauncher]
  {
    %missileType = missile
	%homingType = AGM
	
	%targetingType = heat
	%heatThreshold = 0.5
	%radarLOAL = true
	%uncagedLock = true
	%lockedSensorFOV = 0.1
	%flareEffectivity = 0.1
	%maxOffBoresight = 65 //was 65, increased to permit VLS firing	
  }
  %MODULE[BDExplosivePart]
  {
  	%tntMass = 265 //was 85.5, high enough to basically 1 shot a turret reliably if it hits
	%caliber = 305
	%apMod = 0.3351975632 // 950 mm of penetration, given that missiles hit top-down, this is more then enough to go clean through any tank
	%warheadType = ShapedCharge
  }
}

@PART[bahaATG_ER]:FINAL //Lucerne
{
  %MODULE[MissileLauncher]
  {
    %missileType = missile
	%homingType = AGM
	
	%targetingType = heat
	%heatThreshold = 0.5
	%radarLOAL = true
	%uncagedLock = true
	%lockedSensorFOV = 0.1
	%flareEffectivity = 0.1
	%maxOffBoresight = 65 //was 65, increased to permit VLS firing	
  }
  %MODULE[BDExplosivePart]
  {
  	%tntMass = 191 //was 85.5, high enough to basically 1 shot a turret reliably if it hits
	%caliber = 305
	%apMod = 0.3351975632 // 950 mm of penetration, given that missiles hit top-down, this is more then enough to go clean through any tank
	%warheadType = ShapedCharge
  }
}

@PART[bahaAim9]:FINAL //Sidewinder
{
  %MODULE[MissileLauncher]
  {
    %missileType = missile
    %flareEffectivity = 0.25 
	%uncagedLock = true
  }
}

@PART[kpaComet]:FINAL //Comet ASRAAM
{
  
  %MODULE[MissileLauncher]
  {
    %missileType = missile
    %flareEffectivity = 0.25 
  }
}

@PART[bahaAim120]:FINAL //Aim120
{
  %MODULE[MissileLauncher]
  {
    %missileType = missile
    %chaffEffectivity = 0.33 
	%gpsUpdates = 0
	%pronavGain = 5
  }
}

@PART[BahaMRSARH]:FINAL //Myrmidon
{
  %MODULE[MissileLauncher]
  {
    %missileType = missile
    %chaffEffectivity = 0.16
  }
}

@PART[BahaERARH]:FINAL //Uhlan
{
  %MODULE[MissileLauncher]
  {
    %missileType = missile
    %chaffEffectivity = 0.33 
  }
}

@PART[BahaHSRRM]:FINAL //Lancer
{
  %MODULE[MissileLauncher]
  {
    %missileType = missile
    %chaffEffectivity = 0.33 
  }
}

@PART[BahaLSRRM]:FINAL //Peltast
{
  %MODULE[MissileLauncher]
  {
    %missileType = missile
    %chaffEffectivity = 0.33 
  }
}

@PART[BahaMRARH]:FINAL //Hoplite
{
  %MODULE[MissileLauncher]
  {
    %missileType = missile
    %chaffEffectivity = 0.33 
  }
}

@PART[BahaMRSAM]:FINAL //Jannisary
{
  %MODULE[MissileLauncher]
  {
    %missileType = missile
    %chaffEffectivity = 0.33 
  }
}

@PART[BahaHSAM]:FINAL //Cataphract
{
  %MODULE[MissileLauncher]
  {
    %missileType = missile
    %chaffEffectivity = 0.33 
  }
}

@PART[bahaLRIR]:FINAL // EIFREET
{
  %MODULE[MissileLauncher]
  {
    %missileType = missile
    %flareEffectivity = 0.3
  }
}

@PART[bahaERIR]:FINAL // BALROG
{
  %MODULE[MissileLauncher]
  {
    %missileType = missile
    %flareEffectivity = 0.3
  }
}

@PART[bahaAdvSRIR]:FINAL //Hellhound
{
  %MODULE[MissileLauncher]
  {
    %missileType = missile
    %flareEffectivity = 0.3
  }
}

@PART[bahaSRIR]:FINAL //Imp
{
  %MODULE[MissileLauncher]
  {
    %missileType = missile
    %flareEffectivity = 0.3
	%maxStaticLaunchRange = 4800 //enough range to make an effective MANPADS
  }
}

@PART[bahaIRSAM]:FINAL //Surtur
{
  %MODULE[MissileLauncher]
  {
    %missileType = missile
    %flareEffectivity = 0.24
	%thrust = 120
	%liftArea = 0.0036
	%maxTorque = 24
	%maxTorqueAero = 0.00048
  }
}

@PART[bahaLSAM]:FINAL //SA-10 Thrall
{
  %rescaleFactor = 0.6
}

@PART[bahaFlogger]:FINAL //R7
{
  %MODULE[MissileLauncher]
  {
    %missileType = missile
    %chaffEffectivity = 0.25 
  }
}

@PART[bahaERAAM]:FINAL //Aim54
{
  %MODULE[MissileLauncher]
  {
    %missileType = missile
    %chaffEffectivity = 0.25 
  }
}

@PART[bahaSRAAM]:FINAL //Firelance
{
  %MODULE[MissileLauncher]
  {
    %missileType = missile
    %flareEffectivity = 0.21
  }
}



@PART[bahaAgm86B]:FINAL //agm86
{
  %MODULE[MissileLauncher]
  {
    %targetingType = Radar
    %activeRadarRange = 80000
    %radarLOAL = True
  }
} 

@PART[bahaLAShM*]:FINAL //Squall
{
%MODULE[MissileLauncher]
  {
    %liftArea = 0.05
	%dragArea = 0.03
	%steerMult = 4
	%maxTorque = 150
	%aeroSteerDamping = 10
	%maneuvergLimit = 10
    %DetonateAtMinimumDistance = True
  }
%MODULE
{
	%name = BDExplosivePart
	%tntMass = 120
}
%MODULE[BDCustomWarhead]
{
   %warheadType = HARPSAP
   %explModelPath = BDArmory/Models/explosion/explosion
   %explSoundPath = BDArmory/Sounds/explode1
   %bulletTexturePath = BDArmory/Textures/bullet
   %maxDeviation = 0
  }
} 
 
@PART[bahaRBS-15*]:FINAL
{
  %MODULE[MissileLauncher]
  {
   %maxTorque = 50
   %steerMult = 12
   %torqueRampUp = 50
   %liftArea = 0.033
   %cruiseThrust = 36
   %aeroSteerDamping = 30

   %DetonateAtMinimumDistance = True

   %CruisePredictionTime = 3
   %CruiseAltitude = 15

   %targetingType = inertial 
   %gpsUpdates = 1

   %terminalGuidanceShouldActivate = true
   %terminalGuidanceType = radar
   %terminalGuidanceDistance = 6000
   %activeRadarRange = 8000
   %radarLOAL = True
   %maxOffBoresight = 60
   %lockedSensorFOV = 20
   %chaffEffectivity = 0.1
   
   %CruisePopupAngle = 5
   %CruisePopupRange = 4200
   %CruisePopupAltitude = 40
   %CruisePopup = true
   %agmDescentRatio = 1.25

   %terminalHoming = true
   %terminalHomingType = weave
   %WeaveUseAGMDescentRatio = false
   %terminalHomingRange = 3800

   %WeaveVerticalG = 1 
   %WeaveHorizontalG = 4
   %WeaveFrequency = 0.06		
   %WeaveTerminalAngle = 15
   %WeaveFactor = 1 
   %WeaveRandomRange = 1.4

   %missileCMRange = 12000
   %missileRadarCrossSection = 0.25

  }
  %MODULE[BDCustomWarhead]
  {
   %warheadType = RBSFRAG
   %explModelPath = BDArmory/Models/explosion/explosion
   %explSoundPath = BDArmory/Sounds/explode1
   %bulletTexturePath = BDArmory/Textures/bullet
   %maxDeviation = 180
  }
  //%MODULE[ModuleECMJammer]
  {
   %alwaysOn = false		
   %resourceDrain = 2		
   %resourceName = ElectricCharge	
   %jammerStrength = 800		
   %lockBreaker = true	
   %lockBreakerStrength = 200	
   %rcsReduction = false		
   %rcsReductionFactor = 0.8		
   %cooldownInterval = -1		
  }
  //%RESOURCE
  {
   name = ElectricCharge
   amount = 90
   maxAmount = 90
  }
}

@PART[bahaPac-3]:FINAL //Patriot
{
  %MODULE[MissileLauncher]
  {
    %missileType = missile
    %chaffEffectivity = 0.02
  }
}

@PART[bahaRIM-66]:FINAL
{
  %MODULE[MissileLauncher]
  {
    %missileType = missile
    %chaffEffectivity = 0.02

	%activeRadarRange = 10000
	%seekerTimeout = 8
	%radarLOAL = true

	// temp fix to RIM G-pull until BDA-E is updated
	%steerMult = 8 
	%maxTorqueAero = 0.02
  }
}

@PART[bahaJdamMk82,bahaJdamMk83,bahaJdamMk84]:FINAL
{
  %MODULE[MissileLauncher]
  {
    %targetingType = Radar
    %activeRadarRange = 80000
    %chaffEffectivity = 0.00
    %homingType = agm
    %maxOffBoresight = 360
    %radarLOAL = True  
  }
}
